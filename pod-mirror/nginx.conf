server {
    listen 80;
    server_name localhost;

    # Proxy Flask admin interface (including /run, /logs, etc.) via /admin
    location /admin/ {
        proxy_pass http://127.0.0.1:5000/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        # Rewrite the URL removing the /admin prefix so that Flask sees the expected paths.
        rewrite ^/admin/(.*)$ /$1 break;
    }

    # Serve mirror files from the downloads directory
    location /downloads/ {
        alias /home/generic/yocto-mirror/downloads/;
        autoindex on;
    }

    # Serve mirror files from the cache directory (if needed)
    location /cache/ {
        alias /home/generic/yocto-mirror/sstate-cache/;
        autoindex on;
    }

    # Optionally, deny or redirect requests for other URLs.
    location / {
        return 404;
    }
}
